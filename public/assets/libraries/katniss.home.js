function strRepeat(t,e){for(var i=0;i<e-1;++i)t+=t;return t}function toDigits(t,e){"undefined"==typeof e&&(e=2);var i=Math.pow(10,e-1);return t<i?strRepeat("0",e-1)+t:t}function urlParam(t){var e=new RegExp("[?&]"+t+"=([^&#]*)").exec(window.location.href);return null==e?null:decodeURIComponent(e[1])||0}function isUnset(t){return void 0==t||"undefined"==typeof t||null==t}function isSet(t){return!isUnset(t)}function isString(t){return"string"==typeof t}function isObject(t,e){return e=isUnset(e)?"[object]":"[object "+e+"]",isSet(t)&&Object.prototype.toString.call(t)===e}function isArray(t){return isObject(t,"Array")}function startWith(t,e){return!!isSet(t)&&0==t.toString().indexOf(e)}function NumberFormatHelper(){this.DEFAULT_NUMBER_OF_DECIMAL_POINTS=2,this.type=KATNISS_SETTINGS.number_format,this.numberOfDecimalPoints=this.DEFAULT_NUMBER_OF_DECIMAL_POINTS}function KatnissApiMessages(t){this.messages=isArray(t)?t:isString(t)?[t]:[]}function KatnissApi(t){this.REQUEST_TYPE_POST="post",this.REQUEST_TYPE_GET="get",this.REQUEST_TYPE_PUT="put",this.REQUEST_TYPE_DELETE="delete",this.isWebApi=isSet(t)&&t===!0}NumberFormatHelper.prototype.modeInt=function(t){this.mode(0)},NumberFormatHelper.prototype.modeNormal=function(t){this.mode(this.DEFAULT_NUMBER_OF_DECIMAL_POINTS)},NumberFormatHelper.prototype.mode=function(t){this.numberOfDecimalPoints=t},NumberFormatHelper.prototype.format=function(t){switch(t=parseFloat(t),this.type){case"point_comma":return this.formatPointComma(t);case"point_space":return this.formatPointSpace(t);case"comma_point":return this.formatCommaPoint(t);case"comma_space":return this.formatCommaSpace(t);default:return t}},NumberFormatHelper.prototype.formatPointComma=function(t){return t.toFixed(this.numberOfDecimalPoints).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")},NumberFormatHelper.prototype.formatPointSpace=function(t){return t.toFixed(this.numberOfDecimalPoints).replace(/(\d)(?=(\d{3})+\.)/g,"$1 ")},NumberFormatHelper.prototype.formatCommaPoint=function(t){return t=this.formatPointSpace(t),t.replace(".",",").replace(" ",".")},NumberFormatHelper.prototype.formatCommaSpace=function(t){return t=this.formatPointSpace(t),t.replace(".",",")},KatnissApiMessages.prototype.hasAny=function(){return this.messages.length>0},KatnissApiMessages.prototype.all=function(){return this.messages},KatnissApiMessages.prototype.first=function(){return this.hasAny()?this.messages[0]:""},KatnissApi.prototype.switchToAppApi=function(){this.isWebApi=!1},KatnissApi.prototype.switchToWebApi=function(){this.isWebApi=!0},KatnissApi.prototype.buildUrl=function(t){var e=this.isWebApi?KATNISS_WEB_API_URL:KATNISS_API_URL;return startWith(t,e)?t:e+"/"+t},KatnissApi.prototype.buildParams=function(t){return isUnset(t)&&(t={}),this.isWebApi?(isObject(t,"FormData")?t.append("_token",KATNISS_REQUEST_TOKEN):t._token=KATNISS_REQUEST_TOKEN,t):(isObject(t,"FormData")?(t.append("_app",JSON.stringify(KATNISS_APP)),t.append("_settings",JSON.stringify(KATNISS_SETTINGS))):(t._app=KATNISS_APP,t._settings=KATNISS_SETTINGS),t)},KatnissApi.prototype.buildOptions=function(t,e,i){return isSet(i)||(i={}),i.type=t,i.data=this.buildParams(e),isSet(i.dataType)||(i.dataType="json"),isObject(e,"FormData")&&(i.processData=!1,i.contentType=!1),i},KatnissApi.prototype.beforeRequest=function(){this.isWebApi&&startSessionTimeout()},KatnissApi.prototype.post=function(t,e,i,n,s){this.beforeRequest(),this.promise(jQuery.post(this.buildUrl(t),this.buildParams(e)),i,n,s)},KatnissApi.prototype.get=function(t,e,i,n,s){this.beforeRequest(),this.promise(jQuery.get(this.buildUrl(t),this.buildParams(e)),i,n,s)},KatnissApi.prototype.request=function(t,e,i,n,s,o,r){this.beforeRequest(),this.promise(jQuery.ajax(this.buildUrl(t),this.buildOptions(e,i,n)),s,o,r)},KatnissApi.prototype.promise=function(t,e,i,n){var s=this;t.done(function(t){isSet(e)&&e.call(s,s.isFailed(t),s.data(t),s.messages(t))}).fail(function(t,e,n){isSet(i)&&i.call(s,e,n)}).always(function(){isSet(n)&&n.call(s)})},KatnissApi.prototype.isFailed=function(t){return isSet(t._success)&&1!=t._success},KatnissApi.prototype.data=function(t){return isSet(t._data)?t._data:null},KatnissApi.prototype.messages=function(t){return new KatnissApiMessages(t._messages)},$(function(){function t(t){KATNISS_REQUEST_TOKEN=t,jQuery('input[type="hidden"][name="_token"]').val(t)}function e(){isSet(i)&&clearTimeout(i),i=setTimeout(function(){if(KATNISS_USER===!1){var e=new KatnissApi((!0));e.get("user/csrf-token",null,function(e,i,n){e||t(i.csrf_token)})}else x_lock()},KATNISS_SESSION_LIFETIME)}var i=null;e()}),$(function(){function t(t,e,i,n){var s=[];for(var o in i)s.push(o+"="+i[o]);return window.open(t,e,s.join(","),n)}var e=1050;$(document).on("shown.bs.modal",".modal",function(t){$(this).css("z-index",++e)}),$(document).on("click",".go-url",function(t){t.preventDefault();var e=$(this).attr("data-url");e&&(window.location.href=e)}).on("click",".open-window",function(e){e.preventDefault();var i=$(this),n=$.extend(i.data()),s="",o="",r=!0,a=null;n.url?(s=n.url,delete n.url):i.is("a")?s=i.attr("href"):i.is("img")&&(s=i.attr("src")),n.name&&(o=n.name,delete n.name),n.replace&&(r=n.replace,delete n.replace),n.callback&&(a=n.callback,delete n.callback);var p=t(s,o,n,r);return a&&"string"==typeof a&&window[a](this,p),!1})});